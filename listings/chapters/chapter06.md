# Making music on the BBC micro

## Chapter 6

### Vibrato and Tremelo

```
10 ENVELOPE1,1,0,3,-3,0,20,20,63,-1,0,-4,126,100
20 SOUND1,1,101,160
```
### Comparing envelopes
```
10 REM PROGRAM 6.1
20 REM Envelope Comparisons 
30
40 VDU15
50 ON ERROR GOTO 230
60 REM Reset Delay on Keys
70 *FX12,0
80 *KEY0 RUN|M
90 *KEY10 OLD|MLIST|M
100 PROCEnvelope
110
120 REPEAT
130 PRINT"Which Envelope?";
140 REPEAT
150 Env=GET-48
160 UNTIL Env>-1 AND Env<10
170 PRINT;TAB(16)Env
180 IF Env=0 SOUND1,-12,Pitch,40 ELSE SOUND1,Env,Pitch,40
190 UNTIL FALSE
200
210 REM Escape Routine
220 REM Speed Up Key Repeat
230 *FX12,6
240 *FX11,20
250 ON ERROR WHEN 280,
260 ERROR
270
280 DEF PROCEnvelope
290 Pitch=149
300 ENVELOPE1,4,0,0,1,1,0,1,4,-1,0,-3,126,80
310 ENVELOPE2,2,0,0,1,2,0,2,4,-1,0,-3,126,80
320 ENVELOPE3,3,0,0,1,2,0,2,4,-1,0,-3,126,80
330 ENVELOPE4,4,-2,1,1,1,1,1,4,-1,0,-3,126,80
340 ENVELOPE5,6,1,-2,1,1,1,1,4,-1,0,-3,126,80
350 ENVELOPE6,4,1,1,1,1,1,1,4,-1,0,-3,126,80
360 ENVELOPE7,4,0,8,-8,0,1,1,16,-1,0,-3,126,80
370 ENVELOPE8,4,0,28,-28,0,1,1,16,-1,0,-3,126,80
380 ENVELOPE9,8,0,8,-12,1,1,1,16,-1,0,-3,126,80
390 ENDPROC
```

### Producing tremolo effects
```
10 REM PROGRAM 6.2
20 REM Tremolo Demonstration
30
40 PROCTremolo(&1,1,-1)
50 PROCTremolo(&1,1,-.25)
60 END
70
80 DEF PROCTremolo(Chan,Dur,Step)
90 PRINT"Chan=";Chan;" Dur=";Dur;" Step=";Step
100 REPEAT
110 FOR Amp=-2 TO -15 STEP Step
120 SOUND Chan,Amp,53,Dur
130 NEXT Amp
140 FOR Amp=-14 TO -3 STEP ABS(Step)
150 SOUND Chan,Amp,53,Dur
160 NEXT Amp
170 UNTIL INKEY$(2)=" "
180 ENDPROC
190
200 REM Tremolo Using Env Control
210
220 ENVELOPE1,5,0,0,0,0,0,0,8,-8,0,-8,120,16
230 FOR Trem=1 TO 8 240 SOUND1,1,53,28
250 NEXT Trem
260 END
270
280 REM Faster Tremolo
290
300 ENVELOPE1,2,0,0,0,0,0,0,8,-8,0,-8, 120,104
310 FOR Trem=1 TO 30
320 SOUND1,1,53,2
330 NEXT Trem
```

#### Flush
```
40 PROCTremolo(&11,1,-1)
```
#### Listing 6.2 With Flush
```
10 REM PROGRAM 6.2
20 REM Tremolo Demonstration
30
40 PROCTremolo(&11,1,-1)
50 PROCTremolo(&1,1,-.25)
60 END
70
80 DEF PROCTremolo(Chan,Dur,Step)
90 PRINT"Chan=";Chan;" Dur=";Dur;" Step=";Step
100 REPEAT
110 FOR Amp=-2 TO -15 STEP Step
120 SOUND Chan,Amp,53,Dur
130 NEXT Amp
140 FOR Amp=-14 TO -3 STEP ABS(Step)
150 SOUND Chan,Amp,53,Dur
160 NEXT Amp
170 UNTIL INKEY$(2)=" "
180 ENDPROC
190
200 REM Tremolo Using Env Control
210
220 ENVELOPE1,5,0,0,0,0,0,0,8,-8,0,-8,120,16
230 FOR Trem=1 TO 8 240 SOUND1,1,53,28
250 NEXT Trem
260 END
270
280 REM Faster Tremolo
290
300 ENVELOPE1,2,0,0,0,0,0,0,8,-8,0,-8, 120,104
310 FOR Trem=1 TO 30
320 SOUND1,1,53,2
330 NEXT Trem
```
#### Vibrato in the pitch envelope
```
220 ENVELOPE1,5,1,-2,1 ,1,1,1,8,-8,0,-8,120,16
```
### Trills: a special kind of vibrato

```
10 REM PROGRAM 6.3
20 REM "Military Music" Introduction
30
40 ENVELOPE1,4,0,8,-8,0,1,1,63,0,0,-12,126,126
50 ENVELOPE2,3,0,0,1,2,0,2,126,-8,0,-8,126,30
55 ENVELOPE3,4,0,0,1,1,0,1,32,-1,0,-8,96,60
60 SOUND1,1,149,54
70 FOR Note=1 TO 9
80 READ Pitch,Dur
90 SOUND2,3,Pitch,Dur
100 SOUND3,2,Pitch+48,Dur
110 NEXT Note
120 END
130 DATA 53,12,49,4,45,12,41,4,33,4,25,4,21,4,13,4,5,6
```
### Producing echoes on the BBC micro
```
10 REM PROGRAM 6.4
20 REM Echo Production
30 REM Using Multiple Envelopes
40
50 Dur=3
60 ENVELOPE1,1,0,0,0,0,0,0,126,-4,-4,-6,126,102
70 ENVELOPE2,1,0,0,0,0,0,0,102,-4,-4,-6,102,78
80 ENVELOPE3,1,0,0,0,0,0,0,78,-4,-4,-6,78,54
90 ENVELOPE4,1,0,0,0,0,0,0,54,-4,-4,-6,54,30
100 ENVELOPE5,1,0,0,0,0,0,0,30,-4,-4,-6,30,6
110 SOUND1,1,101,Dur
120 SOUND1,2,101,Dur
130 SOUND1,3,101,Dur
140 SOUND1,4,101,Dur
150 SOUND1,5,101,Dur
```
#### Disable the SOUND command
```
110 SOUND1,1,101 ,Dur:SOUND1,1,101,Dur
```

```
10 REM PROGRAM 6.5
20 REM Echo Using a Procedure
30
40 EchoSpeed=10
50 RateOfDecay=3
60
70 FOR Note=1 TO 5
80 READ Chan,Pitch,Dur
90 PROCEcho
100 NEXT
110 END
120
130 DATA 1,5,16,2,33,16,3,53,28,1,69,2,2,65,32
140
150 DEF PROCEcho
160 AA=126
170 FOR Count=1 TO Dur
180 ALD=AA-RateOfDecay
190 ENVELOPE1,1,0,0,0,0,0,0,AA,-4,-4,-1,AA,ALD
200 SOUNDChan,1,Pitch,1
210 TIME=0:REPEAT UNTIL TIME>EchoSpeed
220 AA=ALD
230 NEXT Count
240 ENDPROC
```
### Pseudo echo

```
10 REM PROGRAM 6.6
20 REM Pseudo Echoes Using
30 REM Single Envelopes
40 REM Insert in PROGRAM 6.1
50
60 ENVELOPE1,20,12,-12,0,1,1,0,126,-6,-6,-6,126,0
70
80 ENVELOPE2,4,4,0,32,4,1,0,126,-1,-1 ,-1,126,0
90
100 ENVELOPE3,4,4,16,12,1,1,1,126,-1,-1,-1,126,0
110
120 ENVELOPE4,6,8,-16,8,8,4,2,126,-1,- 1,-1,126,0
130 ENVELOPE5,4,32,-64,4,1,1,16,126,-1 ,-1,-1,126,0
```
#### Combined with listing 6.1

???


### Using the pitch envelope to play tunes
```
10 ENVELOPE1,11,16,4,8,2,1,1,100,0,0,-100,100,100
20 SOUND1,1,101,20
```

```
10 ENVELOPE1,136,12,-4,4,17,60,12,100,0,0,-100,100,100
20 SOUND1,1,41,144
```

```
10 ENVELOPE1,10,8,-8,0,18,18,6,100,0,0,-100,100,100
20 SOUND1,1,45,84
```

```
10 ENVELOPE1,9,20,20,0,10,10,5 ,100,0,0,-100,100,100
20 SOUND1,1,149,135
```

### Delay effects on the BBC micro
```
10 REM PROGRAM 6.7
20 REM Chorus Effects
30
40 REM Alter Pitch
50 REM To Other Values
60 Pitch=227
70
80 REM 2 Channels
90 SOUND1,-12,Pitch,120
100 SOUND2,-12,Pitch,120
110 Next=GET
120
130 REM 3 Channels
140 SOUND1,-12,Pitch,120
150 SOUND2,-12,Pitch,120
160 SOUND3,-12,Pitch,120
170 Next=GET
180
190 REM 2 Channels with Increased 
200 REM Pitch Value
210 SOUND1,-12,Pitch,120
220 SOUND2,-12,Pitch+1,120
230 Next=GET
240
250 REM 3 Channels with Increased
260 REM Pitch Value
270 SOUND1,-12,Pitch,120
280 SOUND2,-12,Pitch+1,120
290 SOUND3,-12,Pitch-1,120
300 Next=GET
310
320 REM Pseudo Chorus
330 REM Using Fast Vibrato
340 ENVELOPE1,1,0,0,1,1,0,1,100,0,0,-100,100,100
350 SOUND1,1,Pitch,120
```


### Beat frequencies: the weaving in and out

```
10 SOUND1,-12,52,120
20 SOUND2,-12,53,120
```

```
10 REM PROGRAM 6.8
20 REM French Accordion Music
30 REM Using Chorus Effect
40
50 ENVELOPE1,3,0,0,0,0,0,0,8,-1,0,-6,124,60
60
70 FOR Tune=1 TO 16
80 READ Note,Dur
90 IF Note=0 Amp=0 ELSE Amp=1
100 SOUND1,Amp,Note,Dur
110 SOUND2,Amp,Note,Dur
120 NEXT Tune
130 END
140
150 DATA 61,8,77,8,113,8,109,72
160 DATA 61,8,81,8,113,8,109,32
170 DATA 0,8,93,8,101,8,0,4,65,4,61,4,53,4,61,4
```

#### Better
```
110 SOUND2,Amp,Note+1,Dur
```
#### Listing 6.8 with better
```
10 REM PROGRAM 6.8
20 REM French Accordion Music
30 REM Using Chorus Effect
40
50 ENVELOPE1,3,0,0,0,0,0,0,8,-1,0,-6,124,60
60
70 FOR Tune=1 TO 16
80 READ Note,Dur
90 IF Note=0 Amp=0 ELSE Amp=1
100 SOUND1,Amp,Note,Dur
110 SOUND2,Amp,Note+1,Dur
120 NEXT Tune
130 END
140
150 DATA 61,8,77,8,113,8,109,72
160 DATA 61,8,81,8,113,8,109,32
170 DATA 0,8,93,8,101,8,0,4,65,4,61,4,53,4,61,4
```


### Bells and the BBC micro
```
10 SOUND1,-15,160,60
20 SOUND2,-15,26,60
```

```
10 REM PROGRAM 6.9
20 REM Bells and Chimes
30
40 ENVELOPE1,4,0,0,0,0,0,0,126,-1,-1,-1,126,0
50
60 FOR Pitch=1 TO 8
70 READ Note,Dur
80 SOUND1,1,Note,Dur
90 SOUND2,1,Note+120,Dur
100 NEXT Pitch
110
120 SOUND1,1,117,64
130 SOUND2,1,6,64
140 SOUND1,1,129,16
150 SOUND2,1,53,16
160 END
170
180 DATA 117,16,101,16,109,16,81,32
190 DATA 81,16,109,16,117,16,101,64

10 FOR Bell=1 TO 20
20 SOUND1,-15,RND(101),10
30 SOUND2,-15,RND(153)+102,10
40 NEXT Bell
```
